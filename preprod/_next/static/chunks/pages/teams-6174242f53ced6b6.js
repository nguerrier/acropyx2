(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[219],{2023:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(3366),a=n(7462),i=n(7294),o=n(6010),s=n(7192),c=n(1496),l=n(1657),u=n(8979);function d(e){return(0,u.Z)("MuiCardActions",e)}(0,n(6087).Z)("MuiCardActions",["root","spacing"]);var p=n(5893);const f=["disableSpacing","className"],m=(0,c.ZP)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableSpacing&&t.spacing]}})((({ownerState:e})=>(0,a.Z)({display:"flex",alignItems:"center",padding:8},!e.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})));var h=i.forwardRef((function(e,t){const n=(0,l.Z)({props:e,name:"MuiCardActions"}),{disableSpacing:i=!1,className:c}=n,u=(0,r.Z)(n,f),h=(0,a.Z)({},n,{disableSpacing:i}),v=(e=>{const{classes:t,disableSpacing:n}=e,r={root:["root",!n&&"spacing"]};return(0,s.Z)(r,d,t)})(h);return(0,p.jsx)(m,(0,a.Z)({className:(0,o.Z)(v.root,c),ownerState:h,ref:t},u))}))},8445:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(3366),a=n(7462),i=n(7294),o=n(6010),s=n(7192),c=n(5861),l=n(1657),u=n(1496),d=n(8979);function p(e){return(0,d.Z)("MuiCardHeader",e)}var f=(0,n(6087).Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),m=n(5893);const h=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],v=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,a.Z)({[`& .${f.title}`]:t.title,[`& .${f.subheader}`]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),x=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),b=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),g=(0,u.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"});var Z=i.forwardRef((function(e,t){const n=(0,l.Z)({props:e,name:"MuiCardHeader"}),{action:i,avatar:u,className:d,component:f="div",disableTypography:Z=!1,subheader:y,subheaderTypographyProps:w,title:j,titleTypographyProps:P}=n,S=(0,r.Z)(n,h),C=(0,a.Z)({},n,{component:f,disableTypography:Z}),k=(e=>{const{classes:t}=e;return(0,s.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},p,t)})(C);let _=j;null==_||_.type===c.Z||Z||(_=(0,m.jsx)(c.Z,(0,a.Z)({variant:u?"body2":"h5",className:k.title,component:"span",display:"block"},P,{children:_})));let N=y;return null==N||N.type===c.Z||Z||(N=(0,m.jsx)(c.Z,(0,a.Z)({variant:u?"body2":"body1",className:k.subheader,color:"text.secondary",component:"span",display:"block"},w,{children:N}))),(0,m.jsxs)(v,(0,a.Z)({className:(0,o.Z)(k.root,d),as:f,ref:t,ownerState:C},S,{children:[u&&(0,m.jsx)(x,{className:k.avatar,ownerState:C,children:u}),(0,m.jsxs)(g,{className:k.content,ownerState:C,children:[_,N]}),i&&(0,m.jsx)(b,{className:k.action,ownerState:C,children:i})]}))}))},6940:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/teams",function(){return n(694)}])},1194:function(e,t){"use strict";t.Z={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"600px",bgcolor:"background.paper",boxShadow:24,p:4}},694:function(e,t,n){"use strict";n.r(t);var r=n(8520),a=n.n(r),i=n(5893),o=n(7294),s=(n(1163),n(4713)),c=n(6886),l=n(5861),u=n(3321),d=n(9964),p=n(666),f=n(2474),m=n(1458),h=n(7357),v=n(6242),x=n(122),b=n(6540),g=n(8445),Z=n(4267),y=n(2023),w=n(9624),j=n(9661),P=n(4117),S=(n(7497),n(9780),n(5148)),C=n(9233),k=n(1194);function _(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){_(i,r,a,o,s,"next",e)}function s(e){_(i,r,a,o,s,"throw",e)}o(void 0)}))}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){a=!0,i=c}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.default=(0,s.tl)((function(){var e,t=E((0,S.z)(),4),n=t[0],r=t[1],_=(t[2],t[3]),O=(0,s.aF)(),A=(O.user,O.authError,O.authIisLoading,(0,o.useState)([])),R=A[0],M=A[1],I=(0,o.useState)([]),H=I[0],X=I[1],z=(0,o.useState)([]),D=z[0],L=z[1],F=(0,o.useState)(!1),B=F[0],U=F[1],V=(0,o.useState)(!1),W=V[0],$=V[1],J=(0,o.useState)(""),q=J[0],G=J[1],K=(0,o.useState)({}),Q=K[0],Y=K[1],ee=N(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),e.t0=E,e.next=4,(0,C.Xv)("/teams",{expect_json:!0});case 4:if(e.t1=e.sent,t=(0,e.t0)(e.t1,3),n=t[0],r=t[1],t[2],!n){e.next=14;break}return M(!1),X(!1),_("Error while retrieving teams list: ".concat(n)),e.abrupt("return");case 14:r=r.map((function(e){return e.delete="delete",e.update="update",e.id=e._id,e})),M(r),X(r),U(!1);case 18:case"end":return e.stop()}}),e)}))),te=N(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=E,e.next=3,(0,C.Xv)("/pilots",{expect_json:!0});case 3:if(e.t1=e.sent,t=(0,e.t0)(e.t1,3),n=t[0],r=t[1],t[2],!n){e.next=12;break}return L([]),_("Error while retrieving judge levels: ".concat(n)),e.abrupt("return");case 12:L(r);case 13:case"end":return e.stop()}}),e)}))),ne=N(a().mark((function e(t){var n,r,i,o,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n="/teams/new",r="POST",i=201,Q._id&&(n="/teams/".concat(Q._id),r="PUT",i=204),Q.pilots=null!==(o=Q.pilots)&&void 0!==o?o:[],Q.pilots=Q.pilots.map((function(e){return e.civlid})),e.t0=E,e.next=11,(0,C.Xv)(n,{expected_status:i,method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});case 11:if(e.t1=e.sent,s=(0,e.t0)(e.t1,3),c=s[0],s[1],s[2],!c){e.next=19;break}return Q._id?_("error while updating team ".concat(Q._id,": ").concat(c)):_("error while creating new team: ".concat(c)),e.abrupt("return");case 19:$(!1),ee();case 21:case"end":return e.stop()}}),e)}))),re=N(a().mark((function e(t){var r,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target.dataset.id,confirm("Are you sure you want to delete Team ".concat(name," (").concat(r,") ?"))){e.next=3;break}return e.abrupt("return");case 3:return U(!0),e.t0=E,e.next=7,(0,C.Xv)("/teams/".concat(r),{method:"DELETE",expected_status:204});case 7:e.t1=e.sent,i=(0,e.t0)(e.t1,3),o=i[0],i[1],i[2],o?_("Error while deleting Team ".concat(r,": ").concat(o)):n("Team ".concat(r," successfully deleted")),ee();case 14:case"end":return e.stop()}}),e)}))),ae=N(a().mark((function e(t){var n,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(n=t.target.value).normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=new RegExp(n,"i"),o=H.filter((function(e){return e.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").match(i)})),M(o),r("".concat(o.length," teams filtered over ").concat(H.length));case 6:case"end":return e.stop()}}),e)}))),ie=[{id:"name"},{id:"pilots",rewrite:function(e){return(0,i.jsxs)(h.Z,{children:[(0,i.jsxs)(x.Z,{href:e[0].link,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)(j.Z,{alt:e[0].name,src:e[0].photo}),e[0].name]}),(0,i.jsxs)(x.Z,{href:e[0].link,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)(j.Z,{alt:e[1].name,src:e[1].photo}),e[1].name]})]})}},{id:"update",type:"ACTION",func:function(e){var t=e.target.dataset.id,n=R.find((function(e){return e._id==t}));G("Updating team ".concat(t)),Y(n),$(!0)}},{id:"delete",type:"ACTION",func:re}];return(0,o.useEffect)((function(){ee(),te()}),[]),B?(0,i.jsxs)(h.Z,{sx:{width:"100%",textAlign:"center"},children:[(0,i.jsx)(m.Z,{}),"Loading"]}):R?(0,i.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(c.ZP,{item:!0,xs:12,children:(0,i.jsxs)(l.Z,{variant:"h5",children:["Teams",(0,i.jsx)(p.Z,{onClick:ee})]})}),(0,i.jsx)(c.ZP,{item:!0,xs:4,sm:4,children:(0,i.jsx)(f.Z,{fullWidth:!0,id:"outlined-basic",label:"Search team",variant:"outlined",onChange:ae})}),(0,i.jsxs)(c.ZP,{item:!0,xs:8,sm:8,container:!0,children:[(0,i.jsx)(u.Z,{variant:"contained",onClick:function(){G("New team"),Y({}),$(!0)},startIcon:(0,i.jsx)(b.Z,{}),children:"new team"}),(0,i.jsx)(d.Z,{open:W,onClose:function(){return $(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,i.jsx)(v.Z,{sx:k.Z,children:(0,i.jsxs)("form",{onSubmit:ne,children:[(0,i.jsx)(g.Z,{title:q,titleTypographyProps:{variant:"h6"}}),(0,i.jsx)(Z.Z,{children:(0,i.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,i.jsx)(c.ZP,{item:!0,xs:12,children:(0,i.jsx)(f.Z,{fullWidth:!0,name:"name",label:"Name",placeholder:"Team name",defaultValue:null!==(e=Q.name)&&void 0!==e?e:"",onChange:function(e){Q.name=e.target.value,Y(Q)}})}),(0,i.jsx)(c.ZP,{item:!0,xs:12,children:(0,i.jsx)(w.Z,{disablePortal:!0,multiple:!0,id:"autocomplete-pilots",options:D,getOptionLabel:function(e){return"".concat(e.name," (").concat(e.civlid,")")},defaultValue:D.filter((function(e){return!!Q.pilots&&Q.pilots.find((function(t){return t.civlid==e.civlid}))})),renderInput:function(e){return(0,i.jsx)(f.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){T(e,t,n[t])}))}return e}({},e,{name:"pilots",label:"Pilots"}))},onChange:function(e,t){Q.pilots=t,Y(Q)}})})]})}),(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(u.Z,{size:"large",type:"submit",sx:{mr:2},variant:"contained",children:"Submit"}),(0,i.jsx)(u.Z,{size:"large",color:"secondary",variant:"outlined",onClick:function(){return $(!1)},children:"Cancel"})]})]})})})]}),(0,i.jsx)(c.ZP,{item:!0,xs:12,children:(0,i.jsx)(v.Z,{children:(0,i.jsx)(P.Z,{rows:R,headCells:ie,orderById:"name"})})})]}):(_("Empty or invalid data"),"")}))}},function(e){e.O(0,[808,698,109,725,335,774,888,179],(function(){return t=6940,e(e.s=t);var t}));var t=e.O();_N_E=t}]);